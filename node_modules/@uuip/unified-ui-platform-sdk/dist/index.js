!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var s in i)("object"==typeof exports?exports:e)[s]=i[s]}}(self,(()=>(()=>{"use strict";var e={n:t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},d:(t,i)=>{for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{AssertUtils:()=>Q,BrowserNotification:()=>u,Decorator:()=>S,Err:()=>f,Evt:()=>T,I18N:()=>R,Logger:()=>c,NotificationItemsContent:()=>N,Notifications:()=>$,Signal:()=>z,clearInterval:()=>K,clearTimeout:()=>X,createBrowserNotifications:()=>h,createHttp:()=>M,createLogger:()=>d,createNotifications:()=>J,ensureError:()=>ee,setInterval:()=>Y,setTimeout:()=>Z});const i=require("event-emitter");var s=e.n(i);const n=require("luxon"),o="*********";class r{constructor(e){this.maskKeys=e}tryJSONParse(e){try{return JSON.parse(e)}catch(e){return}}copiedObj(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return e}}maskObjectProperty(e){const t=e;Object.keys(e).forEach((i=>{"object"==typeof e[i]&&null!==e[i]?this.maskObjectProperty(e[i]):t[i]=o}))}maskLogData(e){Object.keys(e).forEach((t=>{"object"==typeof e[t]&&null!==e[t]?this.maskKeys[t]?this.maskObjectProperty(e[t]):this.maskLogData(e[t]):(this.maskKeys[t]&&"string"==typeof e[t]||"value"===t&&this.maskKeys[e.name])&&(e[t]=o)}))}maskPIIInformation(e){const t=e[e.length-1],i="string"==typeof t?this.tryJSONParse(t):this.copiedObj(t);i&&"object"==typeof i&&(this.maskLogData(i),e.splice(e.length-1,1,i))}}const a=(...e)=>e.map((e=>"string"==typeof e?e:JSON.stringify(e)));var c;function d(e,t){const i=new c.Service(e,t);return c.POOL.addLogger(i),i}!function(e){e.MAX_LOGS_SIZE=1048576,e.LS_LOGS_KEY="uuip-client-logs";const t="<uuip-eol>",i=/[\u0100-\uFFFF]/g,o="yyyy-LL-dd HH:mm:ss:SSS";let c;e.defaultSaveIntervalMilliSeconds=5e3,function(e){e[e.Trace=1]="Trace",e[e.Debug=2]="Debug",e[e.Warn=3]="Warn",e[e.Error=4]="Error",e[e.Fatal=5]="Fatal"}(c=e.Level||(e.Level={})),e.Service=class{constructor(e,t){this.loggerEmitter=s()(),this.prefix=e,this.maskKeys=t}log(t,...i){this.maskKeys&&"object"==typeof this.maskKeys&&((e,t)=>{new r(t).maskPIIInformation(e)})(i,this.maskKeys);const s=a(this.prefix?[`${this.prefix}`,...i]:i),c=Date.now(),d=n.DateTime.fromMillis(c).toFormat(o);switch(t){case e.Level.Trace:console.info(d,...s);break;case e.Level.Debug:console.log(d,...s);break;case e.Level.Warn:console.warn(d,...s);break;case e.Level.Error:case e.Level.Fatal:console.error(d,...s);break;default:console.log(...s)}const l={pfx:this.prefix,msgs:[...i],ts:c,lvl:t};this.emit("add",l)}info(...e){this.log(c.Trace,...e)}debug(...e){this.log(c.Debug,...e)}warn(...e){this.log(c.Warn,...e)}error(...e){this.log(c.Error,...e)}emit(e,...t){this.loggerEmitter.emit(e,...t)}addEventListener(e,t){return this.loggerEmitter.on(e,t),()=>{this.removeEventListener(e,t)}}removeEventListener(e,t){this.loggerEmitter.off(e,t)}};class d{constructor(){this.loggers=new Map,this.logsCollectionString="",this.prefixedLogsCollections={},this.lastSaveTime=Date.now(),this.config={saveIntervalMilliSeconds:e.defaultSaveIntervalMilliSeconds},this.logRecordsSerializedLength=0,this.flush=()=>{this.save(!1)},this.onLoggerAddRecord=e=>{this.addLogRecord(e),this.save(!0)},this.restore()}static getSerializedJsonLogRecordBytesSize(e=""){const t=e.length;if(t){const s=e.replace(i,"").length;return 1*s+2*(t-s)}return t}get serializedJsonLogsBytesSize(){const e=this.logsCollectionString.split(t).length;return 2+this.logRecordsSerializedLength+1*(e-1)}save(t=!0){const i=Date.now();t&&i-this.lastSaveTime<this.config.saveIntervalMilliSeconds||(this.lastSaveTime=i,window.sessionStorage.setItem(e.LS_LOGS_KEY,this.logsCollectionString))}restore(){try{const t=window.sessionStorage.getItem(e.LS_LOGS_KEY)||"";this.logsCollectionString=t,this.logRecordsSerializedLength+=d.getSerializedJsonLogRecordBytesSize(this.logsCollectionString),this.restorePreFixedLogs()}catch(e){console.warn("Logger failed read logs from sessionStorage: ",e)}}getLogObjectFromString(){try{return""!==this.logsCollectionString?JSON.parse(`[${this.logsCollectionString.split(t).join(",")}]`):[]}catch(e){console.log("Error parsing local storage data")}}restorePreFixedLogs(){const e=this.getLogObjectFromString();e&&Array.isArray(e)&&e.length>0&&e.forEach((e=>{this.addPreFixedLogs(e),this.removeOversized()}))}addPreFixedLogs(e){this.prefixedLogsCollections[e.pfx]=this.prefixedLogsCollections[e.pfx]||new Set,this.prefixedLogsCollections[e.pfx].add(e)}removeOversized(){for(;this.serializedJsonLogsBytesSize>e.MAX_LOGS_SIZE&&""!==this.logsCollectionString;)this.removeLogRecord()}removeTextFromString(e,t,i){return`${e.slice(0,t)}${e.slice(i+t)}`}addLogRecord(e){try{const i=JSON.stringify(e),s=this.logsCollectionString;this.logsCollectionString=null==s?void 0:s.concat(`${""!==s.trim()?t:""}${i}`)}catch(t){const i=JSON.stringify(e);this.logsCollectionString=i,console.warn("Logger failed read logs from sessionStorage: ",t)}this.logRecordsSerializedLength+=d.getSerializedJsonLogRecordBytesSize(JSON.stringify(e)),this.addPreFixedLogs(e),this.removeOversized()}removeLogRecord(){if(""!==this.logsCollectionString){const e=this.logsCollectionString.indexOf(t);if(-1!==e){const t=this.logsCollectionString.substring(0,e),i=e+10,s=this.removeTextFromString(this.logsCollectionString,0,i);this.logsCollectionString=s,this.logRecordsSerializedLength-=d.getSerializedJsonLogRecordBytesSize(t);try{const e=JSON.parse(t);this.prefixedLogsCollections[e.pfx]&&this.prefixedLogsCollections[e.pfx].forEach((t=>{t.ts===e.ts&&this.prefixedLogsCollections[e.pfx].delete(t)}))}catch(e){console.warn("Logger failed to read/parse the first logs from sessionStorage: ",e)}}}}removePreFixedLogs(e){const i=this.getLogObjectFromString();e.forEach((e=>{const t=i.findIndex((t=>t.pfx===e.pfx));-1!==t&&(i.splice(t,1),this.logRecordsSerializedLength-=d.getSerializedJsonLogRecordBytesSize(JSON.stringify(e)),this.prefixedLogsCollections[e.pfx]&&this.prefixedLogsCollections[e.pfx].has(e)&&this.prefixedLogsCollections[e.pfx].delete(e))})),this.logsCollectionString=i.map((e=>JSON.stringify(e))).join(t)}static getLogRecordReadable(e){if(e.ts)return{prefix:e.pfx,messages:e.msgs,timestamp:n.DateTime.fromMillis(e.ts).toFormat(o),level:c[e.lvl]}}static getLogsReadableJson(e){const t=e=>e.map((e=>d.getLogRecordReadable(e)));return JSON.stringify(Array.isArray(e)?t(e):Object.keys(e).reduce(((i,s)=>(i[s]=t(e[s]),i)),{}),null,2)}static getLogsReadableText(e){const t=e=>e.reduce(((e,t)=>{const i=d.getLogRecordReadable(t);return i&&(e+=`${i.timestamp} ${i.prefix} ${i.level} ${a(i.messages).join(" ")} \r\n`),e}),"");return Array.isArray(e)?t(e):Object.keys(e).reduce(((i,s)=>(i+=`[SERVICE "${s}" LOGS]: `)+t(e[s])),"")}static getLogsUrl(e){return`data:text/plain;charset=utf-8,${encodeURIComponent(e)}`}static browserDownload(e,t){try{if(document&&document.createElement){const i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("download",t),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}else console.warn("Browser is not supported to download logs")}catch(e){}}addLogger(e){this.loggers.set(e.prefix,e),e.removeEventListener("add",this.onLoggerAddRecord),e.addEventListener("add",this.onLoggerAddRecord)}getAllLogsJsonUrl(){return d.getLogsUrl(d.getLogsReadableJson(this.getLogObjectFromString()))}getAllPrefixedLogsJsonUrl(){return d.getLogsUrl(d.getLogsReadableJson(this.getAllPrefixedLogsCollections()))}getPrefixedLogsJsonUrl(e){return d.getLogsUrl(d.getLogsReadableJson(this.getPrefixedLogsCollection(e)))}getAllLogsTextUrl(){return d.getLogsUrl(d.getLogsReadableText(this.getLogObjectFromString()))}getPrefixedLogsTextUrl(e){return d.getLogsUrl(d.getLogsReadableText(this.getPrefixedLogsCollection(e)))}browserDownloadAllLogsJson(){d.browserDownload(this.getAllLogsJsonUrl(),`${new Date}_all_logs.json`)}browserDownloadAllPrefixedLogsJson(){d.browserDownload(this.getAllPrefixedLogsJsonUrl(),`${new Date}_all_prefixed_logs.json`)}browserDownloadPrefixedLogsJson(e){d.browserDownload(this.getPrefixedLogsJsonUrl(e),`${new Date}_${e}_logs.json`)}browserDownloadAllLogsText(){d.browserDownload(this.getAllLogsTextUrl(),`${new Date}_all_logs.log`)}browserDownloadPrefixedLogsText(e){d.browserDownload(this.getPrefixedLogsTextUrl(e),`${new Date}_${e}_logs.log`)}cleanupAllLogs(){this.logRecordsSerializedLength=0,this.logsCollectionString="",Object.keys(this.prefixedLogsCollections).forEach((e=>this.prefixedLogsCollections[e]=new Set)),this.save(!0)}cleanupPrefixedLogs(e){const t=this.getPrefixedLogsCollection(e);this.removePreFixedLogs(t),this.prefixedLogsCollections[e]=new Set,this.save(!0)}getAllPrefixedLogsCollections(){return Object.keys(this.prefixedLogsCollections).reduce(((e,t)=>(e[t]=this.getPrefixedLogsCollection(t),e)),{})}getPrefixedLogsCollection(e){return Array.from(this.prefixedLogsCollections[e]||new Set)}}e.ServicesPool=d,e.POOL=new e.ServicesPool}(c||(c={}));const l=d("unified-ui-platform-sdk",{title:!0,text:!0});var u;function h(e){return new u.Service(e)}function g(e,t){if(e.descriptor=e.descriptor||Object.getOwnPropertyDescriptor(e.target,e.key),"function"!=typeof e.descriptor.value)return console.warn(e.key,"Decorator must be used on function"),e.descriptor;const i=e.descriptor.value,s=e.target.constructor.name;return e.descriptor.value=function(){const e=[];for(let t=0;t<arguments.length;t++)e[t]=arguments[t];return t.call(this,i,e,s)},e.descriptor}function m(e=250){return function(t,i,s){let n;return g({target:t,key:i,descriptor:s},(function(t,i){clearTimeout(n),n=window.setTimeout((()=>{clearTimeout(n),t.apply(this,i)}),e)}))}}function p(){return(e,t)=>{const i={get(){return new T(this,void 0!==t?t:e.key)},enumerable:!0,configurable:!0};return void 0!==t?Object.defineProperty(e,t,i):{kind:"method",placement:"prototype",key:e.key,descriptor:i}}}!function(e){class t{static get isBrowserNotificationPromiseSupported(){try{window.Notification.requestPermission().then()}catch(e){return!1}return!0}constructor(e){this.defaultOptions=e||{}}get isBrowserNotificationSupported(){return!!("Notification"in window)}get isBrowserNotificationIconSupported(){return this.isBrowserNotificationSupported&&"icon"in window.Notification.prototype}get isBrowserNotificationImageSupported(){return this.isBrowserNotificationSupported&&"image"in window.Notification.prototype}get isBrowserNotificationBadgeSupported(){return this.isBrowserNotificationSupported&&"badge"in window.Notification.prototype}get isPermissionGranted(){return"granted"===window.Notification.permission}get isPermissionDenied(){return"denied"===window.Notification.permission}get isPermissionUnknown(){return!this.isPermissionGranted&&!this.isPermissionDenied}requestNotificationUserPermission(){return e=this,i=void 0,n=function*(){this.isBrowserNotificationSupported?t.isBrowserNotificationPromiseSupported?yield window.Notification.requestPermission():yield new Promise((e=>window.Notification.requestPermission((t=>e(t))))):l.warn("Browser notification is not supported...")},new((s=void 0)||(s=Promise))((function(t,o){function r(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var i;e.done?t(e.value):(i=e.value,i instanceof s?i:new s((function(e){e(i)}))).then(r,a)}c((n=n.apply(e,i||[])).next())}));var e,i,s,n}fire(e,t){return new window.Notification(e,Object.assign(Object.assign({},this.defaultOptions),t||{}))}}e.Service=t}(u||(u={}));var f;function v(e,t=!0){return function(i,s,n){return g({target:i,key:s,descriptor:n},(function(i,n){return o=this,r=void 0,c=function*(){const o="_"+s+"_exec_flag";if(t&&this[o])return void console.log("PREVENTING DOUBLE EXECUTION");const r=t=>{if(this[o]=t,"function"==typeof e)e.call(this,{isExec:t,ctx:this});else{const i=e;t?i.before&&i.before.call(this,this):i.after&&i.after.call(this,this)}};r(!0);const a=i.apply(this,n);return a instanceof Promise?a.then((()=>r(!1))).catch((()=>r(!1))):(console.warn("Must be async function to use [@Executing] decorator"),r(!1)),a},new((a=void 0)||(a=Promise))((function(e,t){function i(e){try{n(c.next(e))}catch(e){t(e)}}function s(e){try{n(c.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(i,s)}n((c=c.apply(o,r||[])).next())}));var o,r,a,c}))}}!function(e){class t extends Error{constructor(e,t){super(),this.isErr="yes",this.id=e,this.stack=(new Error).stack,"string"==typeof t?this.message=t:t instanceof Error?(this.message=t.message,this.name=t.name):this.message=""}}e.Message=t;class i extends Error{constructor(e,t){super(),this.isErr="yes",this.id=e,this.stack=(new Error).stack,this.details=t}}e.Details=i}(f||(f={}));var S,E=function(e,t,i,s){return new(i||(i=Promise))((function(n,o){function r(e){try{c(s.next(e))}catch(e){o(e)}}function a(e){try{c(s.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((s=s.apply(e,t||[])).next())}))};function w(e){return function(t,i,s){return g({target:t,key:i,descriptor:s},(function(t,s,n){return E(this,void 0,void 0,(function*(){const o=this,r=t=>E(this,void 0,void 0,(function*(){t.id&&"string"==typeof t.id&&"yes"===t.isErr||("string"==typeof t||t instanceof Error?t=new f.Message("system",t):(console.warn("Err must be 'string' or 'new Error()' instance"),t=new f.Message("system","")));const s=t;s.ctx=o;const r=`Error] ${n}.${i} [${s.id}]: ${s.message}`;if("function"==typeof e){const t=e;console.log("[Handled"+r);const i=t.call(o,s);i instanceof Promise&&(yield i)}else{const t=e;if(t[s.id]){console.log("[Handled"+r);const e=t[s.id].call(o,s);e instanceof Promise&&(yield e)}else if(t.handle){console.log("[Handled"+r);const e=t.handle.call(o,s);e instanceof Promise&&(yield e)}else console.warn("[Unhandled "+r);if(t.fallback){const e=t.fallback.call(o,s);e instanceof Promise&&(yield e)}}}));try{const e=t.apply(o,s);return e instanceof Promise?new Promise((t=>{e.then(t).catch((e=>E(this,void 0,void 0,(function*(){yield r(e),t(void 0)}))))})):e}catch(e){return void(yield r(e))}}))}))}}function b(){return function(e,t,i){return g({target:e,key:t,descriptor:i},(function(e,i){const s="_"+t+"_once_flag";if(!this[s])return this[s]=!0,e.call(this,i)}))}}function y(e=1e3/60){return function(t,i,s){let n,o=Date.now();return g({target:t,key:i,descriptor:s},(function(t,i){const s=(...i)=>{const r=Date.now();window.clearTimeout(n),!o||r-o>=e?(o=r,t.apply(this,i)):n=window.setTimeout((()=>s(...i)),e-(r-o))};s(...i)}))}}!function(e){e.Debounce=m,e.Evt=p,e.Exec=v,e.Handle=w,e.Once=b,e.Throttle=y}(S||(S={}));class T{constructor(e,t){this.target=e,this.eventName=t}emit(e,t={bubbles:!0,composed:!0,cancelable:!1}){this.target.dispatchEvent(new CustomEvent(this.eventName,Object.assign({detail:e},t)))}}const L=require("axios");var A=e.n(L);const O=require("uuid"),_="uuip",I="1.0",D="1.0";function M(e){const t=A().create();return t.accessToken=e,t.interceptors.request.use((e=>{if(!e.headers.Authorization&&t.accessToken&&(e.headers.Authorization=`Bearer ${t.accessToken}`),!e.headers.TrackingID){const t=(0,O.v1)();e.headers.TrackingID=`${_}_${t}_${I}:${D}`}return e.headers["Content-Type"]||(e.headers["Content-Type"]="application/json"),e})),t}const x=require("i18next");var C=e.n(x);const k=require("i18next-http-backend");var U=e.n(k);const P=require("i18next-browser-languagedetector");var R,N,j=e.n(P);!function(e){e.createService=e=>{const t=C().createInstance();{const i=e&&e.backend?e.backend:new(U());t.use(i)}{const i=e&&e.languageDetector?e.languageDetector:new(j());t.use(i)}return e&&e.logger&&t.use({log:"log"in e.logger?e.logger.log:e.logger.info,warn:e.logger.warn,error:e.logger.error,type:"logger"}),t},e.mergeServiceInitOptions=(...e)=>Object.assign.call(null,{},...e),e.createMixin=t=>{const i="i18n"in t?t.i18n:e.createService(),s="i18nInitOptions"in t?t.i18nInitOptions:null;s||l.info("i18n mixin instance waiting service initialization outside...");let n=!1;return e=>class extends e{constructor(){super(...arguments),this.onI18NInitialized=e=>this.requestUpdate(),this.onI18NLanguageChanged=e=>this.requestUpdate()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),i.on("initialized",this.onI18NInitialized),i.on("languageChanged",this.onI18NLanguageChanged),i.isInitialized||n||!s||(n=!0,i.init(s).finally((()=>n=!1)))}disconnectedCallback(){i.off("initialized",this.onI18NInitialized),i.off("languageChanged",this.onI18NLanguageChanged),super.disconnectedCallback&&super.disconnectedCallback()}t(...e){return i.t(...e)}}}}(R||(R={})),function(e){e.DataController=class{constructor(e){this.localization={closeButtonText:"Close"},this.type=e.type,this.text=e.text,this.link=e.link,this.linkName=e.linkName,this.linkTooltip=e.linkTooltip,this.iconDetail=e.iconDetail,this.linkHandler=e.linkHandler,this.clickHandler=e.clickHandler,this.errorDetail=e.errorDetail,this.taskId=e.taskId,this.localization=e.localization||this.localization,this.dismissHandler=e.dismissHandler,this.actions=e.actions,this.lineClamp=e.lineClamp}}}(N||(N={}));const H=require("event-emitter/all-off");var $,z,B=e.n(H);function J(e={}){const t=new $.Service;return t.updateConfig(e),t}!function(e){let t,i;!function(e){let t,i,s,n,o,r,a,c;!function(e){e.Info="info",e.Warn="warn",e.Error="error",e.Success="success",e.Chat="chat",e.Default="default"}(t=e.Type||(e.Type={})),e.TYPES=Object.values(t),function(e){e.Silent="silent",e.AutoDismiss="autodismiss",e.Acknowledge="acknowledge"}(i=e.Mode||(e.Mode={})),e.MODES=Object.values(i),function(e){e.Added="added",e.Pended="pended",e.Activated="activated",e.Deactivated="deactivated",e.Removed="removed"}(s=e.Status||(e.Status={})),e.StatusWeight={[s.Added]:0,[s.Pended]:1,[s.Activated]:2,[s.Deactivated]:3,[s.Removed]:4},e.STATUSES=Object.values(s),function(e){e.User="user_add"}(n=e.AddEventReason||(e.AddEventReason={})),function(e){e.ServiceAutoPropagate="service_auto_propagate_pending",e.ServiceAutoDismiss="service_autodismiss_pending",e.UserSilent="user_silent_pending"}(o=e.PendingEventReason||(e.PendingEventReason={})),function(e){e.ServiceAutoPropagate="service_auto_propagate_activate"}(r=e.ActivateEventReason||(e.ActivateEventReason={})),function(e){e.UserNegative="user_negative_deactivate",e.UserPositive="user_positive_deactivate",e.UserNeutral="user_neutral_deactivate"}(a=e.DeactivateEventReason||(e.DeactivateEventReason={})),function(e){e.User="user_remove"}(c=e.RemoveEventReason||(e.RemoveEventReason={}))}(t=e.ItemMeta||(e.ItemMeta={})),function(e){e.STATUS_EVENTS=["add","pending","activate","deactivate","remove"],e.STATUS_EVENT_MAP={add:t.Status.Added,pending:t.Status.Pended,activate:t.Status.Activated,deactivate:t.Status.Deactivated,remove:t.Status.Removed},e.DISABLED_ITEM_MODE={[t.Mode.Silent]:!1,[t.Mode.AutoDismiss]:!1,[t.Mode.Acknowledge]:!1},e.ACTIVATED_ITEM_MODE_LIMIT={[t.Mode.Silent]:0,[t.Mode.AutoDismiss]:10,[t.Mode.Acknowledge]:1},e.AUTO_DISMISS_TIMEOUT=5e3}(i=e.ServiceMeta||(e.ServiceMeta={}));class o{constructor(){this.hubEmitter=s()()}emit(e,...t){this.hubEmitter.emit(e,...t)}addEventListener(e,t){this.hubEmitter.on(e,t)}addOnceEventListener(e,t){this.hubEmitter.once(e,t)}removeEventListener(e,t){this.hubEmitter.off(e,t)}removeAllEventListeners(){B()(this.hubEmitter)}}e.Item=class{get status(){return this._status}get reason(){return this._reason}get mode(){return this._mode}validateAuxOptions(e){let i={};return e&&void 0!==e.AUTO_DISMISS_TIMEOUT&&this.mode===t.Mode.AutoDismiss&&(i=Object.assign(Object.assign({},i),{AUTO_DISMISS_TIMEOUT:e.AUTO_DISMISS_TIMEOUT})),i}constructor(e,i){this._serviceHubSubscriptions=[],this._itemEmitter=s()();const{type:o,mode:r,title:a,data:c,timestamp:d}=e.data;this.type=o,this.title=a,this.data=c,this._mode=r,this.timestamp=d||(new Date).toISOString(),this.datetime=n.DateTime.fromISO(this.timestamp).toLocaleString(n.DateTime.DATETIME_SHORT_WITH_SECONDS),this.options=Object.freeze(this.validateAuxOptions(e.options||{})),i&&(this._serviceHubAdapter=i,this._status=t.Status.Added,this._reason=t.AddEventReason.User,this.bindItemHubListeners())}bindItemHubListeners(){if(this._serviceHubAdapter){{const e=(e,i,s)=>{this.timestamp in e&&(this._status=i,this._reason=s,i===t.Status.Removed&&(this.unbindItemHubListeners(),this.removeAllEventListeners()),this.emit("statusUpdate",i,s))};this._serviceHubAdapter.addEventListener("statusServiceUpdateResponse",e);const i=()=>{var t;null===(t=this._serviceHubAdapter)||void 0===t||t.removeEventListener("statusServiceUpdateResponse",e)};this._serviceHubSubscriptions.push(i)}{const e=(e,t)=>{this.timestamp in e&&(this._mode=t,this.emit("modeUpdate",t))};this._serviceHubAdapter.addEventListener("modeStatusUpdateResponse",e);const t=()=>{var t;null===(t=this._serviceHubAdapter)||void 0===t||t.removeEventListener("modeStatusUpdateResponse",e)};this._serviceHubSubscriptions.push(t)}}}unbindItemHubListeners(){this._serviceHubSubscriptions&&(this._serviceHubSubscriptions.forEach((e=>e())),this._serviceHubSubscriptions.length=0)}deactivate(e){this._status&&t.StatusWeight[this._status]<t.StatusWeight[t.Status.Deactivated]?this._serviceHubAdapter?this._serviceHubAdapter.emit("statusServiceUpdateRequest",this,t.Status.Deactivated,e):l.warn("Service hub adapter is not initialized for this notification item instance: ",this):l.warn(`Notification should have "${t.Status.Pended}" or "${t.Status.Activated}" status to be able change status to "${t.Status.Deactivated}".Current notification status is "${this._status}". Ignoring this change`)}pending(){this._status===t.Status.Activated||this.mode!==t.Mode.Silent?this._serviceHubAdapter?this._serviceHubAdapter.emit("statusServiceUpdateRequest",this,t.Status.Pended,t.PendingEventReason.UserSilent):l.warn("Service hub adapter is not initialized for this notification item instance: ",this):l.warn(`Notification should have "${t.Status.Activated}" status or not "${t.Mode.Silent}" mode, to be able change status to "${t.Status.Pended}" and mode to "${t.Mode.Silent}".Current notification status is "${this._status}" and mode is "${this.mode}". Ignoring this change`)}emit(e,...t){this._itemEmitter.emit(e,...t)}addEventListener(e,t){this._itemEmitter.on(e,t)}addOnceEventListener(e,t){this._itemEmitter.once(e,t)}removeEventListener(e,t){this._itemEmitter.off(e,t)}removeAllEventListeners(){B()(this._itemEmitter)}};const r=(e,t,i=()=>0)=>[...e,...t].sort(i),a=(e,t)=>e.reduce(((e,i)=>(-1===t.indexOf(i)&&e.push(i),e)),[]);class c{constructor(){this.emitter=s()(),this.map={},this.status=c.createStatus(),this.serviceConfig={DISABLED_ITEM_MODE:Object.assign({},i.DISABLED_ITEM_MODE),ACTIVATED_ITEM_MODE_LIMIT:Object.assign({},i.ACTIVATED_ITEM_MODE_LIMIT),AUTO_DISMISS_TIMEOUT:i.AUTO_DISMISS_TIMEOUT},this.activeAutoDismissTimeoutRefs={},this.serviceHubAdapter=new o,this.bindServiceHubEvents()}static mergeConfig(e,...t){if(!t.length)return e;const i=t.shift(),s=e=>e&&"object"==typeof e&&!Array.isArray(e);if(s(e)&&s(i))for(const t in i)s(i[t])?(e[t]||Object.assign(e,{[t]:{}}),this.mergeConfig(e[t],i[t])):Object.assign(e,{[t]:i[t]});return this.mergeConfig(e,...t)}static createStatus(){return{[t.Status.Added]:this.createStatusHolderCollection(),[t.Status.Pended]:this.createStatusHolderCollection(),[t.Status.Activated]:this.createStatusHolderCollection(),[t.Status.Deactivated]:this.createStatusHolderCollection(),[t.Status.Removed]:this.createStatusHolderCollection()}}static createStatusHolderCollection(){return Object.assign([],Object.assign(Object.assign({ids:[]},this.createStatusHolderSubCollections(t.MODES)),this.createStatusHolderSubCollections(t.TYPES)))}static createStatusHolderSubCollections(e){return Object.assign({},e.reduce(((e,t)=>(e[t]=[],e)),{}))}updateNotificationsCollections(){const e=c.createStatus();this.status.added.ids.forEach((i=>{const s=this.map[i];t.STATUSES.forEach((t=>{-1!==this.status[t].ids.indexOf(s.timestamp)&&(e[t].push(s),e[t].ids.push(i),e[t][s.mode].push(s),e[t][s.type].push(s))}))})),this.status=e}setAutoDismiss(e,i=()=>{}){this.prepareUpdateNotifications(e).forEach((e=>{var s;if(e.mode===t.Mode.AutoDismiss){const t=()=>i(e);this.activeAutoDismissTimeoutRefs[e.timestamp]=window.setTimeout(t,null!==(s=e.options.AUTO_DISMISS_TIMEOUT)&&void 0!==s?s:this.serviceConfig.AUTO_DISMISS_TIMEOUT)}}))}removeAutoDismiss(e,t=()=>{}){this.prepareUpdateNotifications(e).forEach((e=>{e.timestamp in this.activeAutoDismissTimeoutRefs&&(t(e),window.clearTimeout(this.activeAutoDismissTimeoutRefs[e.timestamp]),delete this.activeAutoDismissTimeoutRefs[e.timestamp])}))}update(e,t,i){const s=Array.isArray(i)?i:[i];if(s.length){const i=s.map((e=>e.timestamp));switch(e){case"add":s.forEach((e=>this.map[e.timestamp]=e)),this.status.added.ids=r(this.status.added.ids,i,c.sortTimestampsFn);break;case"pending":this.status.pended.ids=r(this.status.pended.ids,i,c.sortTimestampsFn),this.status.activated.ids=a(this.status.activated.ids,i),this.status.deactivated.ids=a(this.status.deactivated.ids,i);break;case"activate":this.status.pended.ids=a(this.status.pended.ids,i),this.status.activated.ids=r(this.status.activated.ids,i,c.sortTimestampsFn),this.status.deactivated.ids=a(this.status.deactivated.ids,i);break;case"deactivate":this.status.pended.ids=a(this.status.pended.ids,i),this.status.activated.ids=a(this.status.activated.ids,i),this.status.deactivated.ids=r(this.status.deactivated.ids,i,c.sortTimestampsFn);break;case"remove":this.status.pended.ids=a(this.status.pended.ids,i),this.status.activated.ids=a(this.status.activated.ids,i),this.status.deactivated.ids=a(this.status.deactivated.ids,i),this.status.added.ids=a(this.status.added.ids,i),this.status.removed.ids=r(this.status.removed.ids,i,c.sortTimestampsFn),i.forEach((e=>delete this.map[e]))}this.updateNotificationsCollections(),this.emit(e,s,t),this.propagate(e,t,s)}}propagate(e,i,s){const n=Array.isArray(s)?s:[s];if(n.length)switch(e){case"add":this.update("pending",t.PendingEventReason.ServiceAutoPropagate,n);break;case"pending":case"deactivate":n.forEach((e=>{this.removeAutoDismiss(e)})),this.update("activate",t.ActivateEventReason.ServiceAutoPropagate,this.prepareActiveCandidatesNotifications(this.status.pended));break;case"activate":n.forEach((e=>{this.setAutoDismiss(e,(e=>{e.mode===t.Mode.AutoDismiss&&this.serviceHubAdapter.emit("statusServiceUpdateRequest",e,t.Status.Pended,t.PendingEventReason.ServiceAutoDismiss)}))}));break;case"remove":this.update("deactivate",t.DeactivateEventReason.UserNegative,n)}}prepareAddNotifications(t){const i=Object.keys(this.serviceConfig.DISABLED_ITEM_MODE).reduce(((e,t)=>(this.serviceConfig.DISABLED_ITEM_MODE[t]||e.push(t),e)),[]).map((e=>`"${e}"`)).join(", ");return(Array.isArray(t)?t:[t]).filter((e=>!this.serviceConfig.DISABLED_ITEM_MODE[e.data.mode]||(l.error(`Trying to .add(...) notification mode "${e.data.mode}" that is disabled in this notifications service instance by configuration.Current configuration is: "${JSON.stringify(this.config)}"Only ${i} allowed. Ignoring .add(${JSON.stringify(e)}) notification...`),!1))).map((t=>new e.Item(t,this.serviceHubAdapter)))}prepareUpdateNotifications(e){return(Array.isArray(e)?e:[e]).reduce(((e,t)=>(t.timestamp in this.map?e.push(t):l.error("Trying to handle untracked notification. Call .add(...) first...",JSON.stringify(t)),e)),[])}prepareActiveCandidatesNotifications(e){const i=(Array.isArray(e)?e:[e]).reduce(((e,t)=>(this.status.activated[t.mode].length+e[t.mode].length<this.serviceConfig.ACTIVATED_ITEM_MODE_LIMIT[t.mode]&&e[t.mode].push(t),e)),c.createStatusHolderSubCollections(t.MODES));return Object.values(i).reduce(((e,t)=>e.concat(t)),[])}static sortByTimestampsFn(e,t){return c.sortTimestampsFn(e.timestamp,t.timestamp)}get added(){return this.status.added}get pended(){return this.status.pended}get activated(){return this.status.activated}get deactivated(){return this.status.deactivated}getNotificationStatus(e){return Object.keys(this.status).filter((e=>e!==t.Status.Added)).find((t=>-1!==this.status[t].ids.indexOf(e.timestamp)))}get config(){return Object.freeze(this.serviceConfig)}static validateUpdateConfig(e){const s=e;if(s.ACTIVATED_ITEM_MODE_LIMIT&&s.ACTIVATED_ITEM_MODE_LIMIT.acknowledge>i.ACTIVATED_ITEM_MODE_LIMIT.acknowledge)throw new Error(`\n          Max ${t.Mode.Acknowledge} limit is ${i.ACTIVATED_ITEM_MODE_LIMIT.acknowledge}\n        `);if(s.DISABLED_ITEM_MODE){if(!Object.keys(s.DISABLED_ITEM_MODE).reduce(((e,t)=>(s.DISABLED_ITEM_MODE[t]&&e++,e)),0))throw new Error("At least one notifications mode should be allowed in service instance");Object.keys(s.ACTIVATED_ITEM_MODE_LIMIT).forEach((e=>{e in s.DISABLED_ITEM_MODE&&s.DISABLED_ITEM_MODE[e]&&l.warn(`Changing configuration limit count for mode "${e}" won't have any effect, because this mode is disabled in notifications service instance`)})),"AUTO_DISMISS_TIMEOUT"in s&&s.DISABLED_ITEM_MODE[t.Mode.AutoDismiss]&&l.warn(`Changing "AUTO_DISMISS_TIMEOUT" configuration option won't have any effect,because "${t.Mode.AutoDismiss}" mode is disabled in notifications service instance`)}return!0}updateConfig(e){c.validateUpdateConfig(e)&&(this.serviceConfig=c.mergeConfig({},this.serviceConfig,e),l.info("Updated notifications service configuration: ",this.config))}add(e){const i=this.prepareAddNotifications(e);return this.update("add",t.AddEventReason.User,i),i}pending(e){const i=this.prepareUpdateNotifications(e);return this.serviceHubAdapter.emit("statusServiceUpdateRequest",i,t.Status.Pended,t.PendingEventReason.UserSilent),i}deactivate(e,i){const s=this.prepareUpdateNotifications(e);return this.serviceHubAdapter.emit("statusServiceUpdateRequest",s,t.Status.Deactivated,i),s}remove(e){const i=this.prepareUpdateNotifications(e);return this.serviceHubAdapter.emit("statusServiceUpdateRequest",i,t.Status.Removed,t.RemoveEventReason.User),i}pendingAllActivated(){return this.pending(this.status.activated)}pendingAll(){return this.pending([...this.status.pended,...this.status.activated])}deactivateAllActivated(e){return this.deactivate(this.status.activated,e)}deactivateAll(e){return this.deactivate([...this.status.pended,...this.status.activated],e)}removeAllDeactivated(){return this.remove(this.status.deactivated)}removeAll(){return this.remove(this.status.added)}addEventListener(e,t){this.emitter.on(e,t)}removeEventListener(e,t){this.emitter.off(e,t)}addOnceEventListener(e,t){this.emitter.once(e,t)}removeAllEventListeners(){B()(this.emitter)}emit(e,...t){this.emitter.emit(e,...t)}bindServiceHubEvents(){this.serviceHubAdapter.addEventListener("statusServiceUpdateRequest",((e,i,s)=>{const n=Array.isArray(e)?e:[e],o=n.reduce(((e,t)=>(e[t.timestamp]=this.getNotificationStatus(t),e)),{});{const e=n.filter((e=>(o[e.timestamp]===t.Status.Activated||e.mode!==t.Mode.Silent)&&i===t.Status.Pended));{const i=e.filter((e=>e.mode!==t.Mode.Silent));i.length&&this.serviceHubAdapter.emit("modeStatusUpdateResponse",i.reduce(((e,t)=>(e[t.timestamp]=t,e)),{}),t.Mode.Silent)}e.length&&this.update("pending",s,e)}{const e=n.filter((e=>{const s=o[e.timestamp];return(s===t.Status.Pended||s===t.Status.Activated)&&i===t.Status.Deactivated}));e.length&&this.update("deactivate",s,e)}n.filter((e=>{const s=o[e.timestamp];return(s===t.Status.Pended||s===t.Status.Activated||s===t.Status.Deactivated)&&i===t.Status.Removed})).length&&this.update("remove",s,e)})),i.STATUS_EVENTS.forEach((e=>{this.addEventListener(e,((t,s)=>{const n=i.STATUS_EVENT_MAP[e],o=t.reduce(((e,t)=>(e[t.timestamp]=t,e)),{});this.serviceHubAdapter.emit("statusServiceUpdateResponse",o,n,s)}))}))}}c.sortTimestampsFn=(e,t)=>e>t?1:e<t?-1:0,e.Service=c}($||($={})),function(e){class t{constructor(){this.listeners=[],this.listenersOnce=[],this.listen=e=>(this.listeners.push(e),{stopListen:()=>this.stopListen(e)}),this.listenOnce=e=>(this.listenersOnce.push(e),{stopListenOnce:()=>this.stopListenOnce(e)}),this.stopListen=e=>{const t=this.listeners.indexOf(e,0);return t>-1&&(this.listeners.splice(t,1),!0)},this.stopListenOnce=e=>{const t=this.listenersOnce.indexOf(e,0);return t>-1&&(this.listenersOnce.splice(t,1),!0)},this.stopListenAll=()=>{this.listeners=[],this.listenersOnce=[]},this.send=e=>{this.listeners.forEach((t=>t(e))),this.listenersOnce.forEach((t=>t(e))),this.listenersOnce=[]}}}class i{constructor(){this.listeners=[],this.listenersOnce=[],this.listen=e=>(this.listeners.push(e),{stopListen:()=>this.stopListen(e)}),this.listenOnce=e=>(this.listenersOnce.push(e),{stopListenOnce:()=>this.stopListenOnce(e)}),this.stopListen=e=>{const t=this.listeners.indexOf(e,0);return t>-1&&(this.listeners.splice(t,1),!0)},this.stopListenOnce=e=>{const t=this.listenersOnce.indexOf(e,0);return t>-1&&(this.listenersOnce.splice(t,1),!0)},this.stopListenAll=()=>{this.listeners=[],this.listenersOnce=[]},this.send=()=>{this.listeners.forEach((e=>e())),this.listenersOnce.forEach((e=>e())),this.listenersOnce=[]}}}e.create=new class{withData(){const e=new t;return{signal:e,send:e.send,stopListenAll:e.stopListenAll}}empty(){const e=new i;return{signal:e,send:e.send,stopListenAll:e.stopListenAll}}}}(z||(z={}));let F=null;const q=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,V=536870912,W=1073741824,G=()=>{if(null!==F)return F;const e=new Blob(['(()=>{"use strict";\nconst e=new Map,t=new Map,r=(e,t)=>\n{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);\n    return{expected:r+o,remainingDelay:o}},\n    o=(e,t,r,i)=>{const s=performance.now();\n        s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};\n        addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;\n        if("interval"===i)\n        (t=>{const r=e.get(t);\n        if(void 0===r)\n        throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));\n        clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});\n        else{if("timeout"!==i)\n        throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));\n        (e=>{const r=t.get(e);if(void 0===r)\n        throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));\n        clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}\n        else{if("set"!==s.method)\n        throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));\n        {const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;\n        if("interval"===d)\n        ((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);\n        e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);\n        else{if("timeout"!==d)\n        throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));\n        ((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);\n        t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();'],{type:"application/javascript; charset=utf-8"}),t=URL.createObjectURL(e);return l.info("Worker url established",t),F=(e=>{const t=new Map([[0,()=>{}]]),i=new Map([[0,()=>{}]]),s=new Map,n=new Worker(e);l.info("worker created ",n);const o=new WeakMap;var r;const a=((e,t)=>i=>{const s=t.get(i);let n=void 0===s?i.size:s<W?s+1:0;if(!i.has(n))return e(i,n);if(i.size<V){for(;i.has(n);)n=Math.floor(Math.random()*W);return e(i,n)}if(i.size>q)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;i.has(n);)n=Math.floor(Math.random()*q);return e(i,n)})((r=o,(e,t)=>(r.set(e,t),t)),o);return n.addEventListener("message",(({data:e})=>{if(void 0!==(n=e).method&&"call"===n.method){const{params:{timerId:n,timerType:o}}=e;if("interval"===o){const e=t.get(n);if("number"==typeof e){const t=s.get(e);if(void 0===t||t.timerId!==n||t.timerType!==o)throw new Error("The timer is in an undefined state.")}else{if(void 0===e)throw new Error("The timer is in an undefined state.");e()}}else if("timeout"===o){const e=i.get(n);if("number"==typeof e){const t=s.get(e);if(void 0===t||t.timerId!==n||t.timerType!==o)throw new Error("The timer is in an undefined state.")}else{if(void 0===e)throw new Error("The timer is in an undefined state.");e(),i.delete(n)}}}else if((e=>null===e.error&&"number"==typeof e.id)(e)){const{id:n}=e,o=s.get(n);if(void 0===o)throw new Error("The timer is in an undefined state.");const{timerId:r,timerType:a}=o;s.delete(n),"interval"===a?t.delete(r):i.delete(r)}else{const{error:{message:t}}=e}var n})),{clearInterval:e=>{const i=a(s);s.set(i,{timerId:e,timerType:"interval"}),t.set(e,i),n.postMessage({id:i,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:e=>{const t=a(s);s.set(t,{timerId:e,timerType:"timeout"}),i.set(e,t),n.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:(e,i)=>{const s=a(t);return t.set(s,(()=>{e(),"function"==typeof t.get(s)&&n.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:s,timerType:"interval"}})})),n.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:s,timerType:"interval"}}),s},setTimeout:(e,t)=>{const s=a(i);return i.set(s,e),n.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:s,timerType:"timeout"}}),s}}})(t),F.setTimeout((()=>URL.revokeObjectURL(t)),0),F},K=e=>G().clearInterval(e),X=e=>G().clearTimeout(e),Y=(e,t)=>G().setInterval(e,t),Z=(e,t)=>G().setTimeout(e,t);var Q;function ee(e){if(e instanceof Error)return e;let t="[Unable to stringify the thrown value]";try{t=JSON.stringify(e)}catch(e){}return new Error(`This value was thrown as is, not through an Error: ${t}`)}return function(e){let t=null;e.setErrorHandler=function(e){t?l.error("Error handler already set"):(l.info(`Setting custom error handler: ${e}`),t=e)},e.check=function(e,i,s){return e||(t?t(i,s):l.info(`Assert failed in ${i}: ${s}`)),e}}(Q||(Q={})),t})()));